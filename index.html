<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Eduardo Ferreira Moura — Portafolio en un mapa</title>
  <meta name="description" content="Portafolio interactivo en mapa: cooperación, desafíos organizacionales, políticas públicas y trabajos de conservación/restauración." />
  <meta name="theme-color" content="#0f172a" />
  <link rel="icon" href="assets/favicon.png" />

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="">
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>

  <style>
    :root{
      --bg:#0b0f1a; --panel:#0e1526; --ink:#e5e7eb; --muted:#a5b4fc; --line:#1f2a44; --card:#111827;
      --coop:#60a5fa;  /* cooperación */
      --org:#a78bfa;   /* organizacional */
      --pol:#34d399;   /* políticas públicas */
      --mano:#f59e0b;  /* manos a la obra */
      --star:#f43f5e;  /* destacado OEI */
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:system-ui,-apple-system,Segoe UI,Inter,Roboto,Arial,sans-serif;
      background:linear-gradient(160deg, var(--bg), #0a0f1d 40%, #0b1224 100%);
      color:var(--ink); -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
    }
    #app{display:grid; grid-template-rows:auto 1fr; height:100%}

    header{
      position:sticky; top:0; z-index:40;
      background:linear-gradient(180deg, rgba(11,15,26,.95), rgba(11,15,26,.75));
      border-bottom:1px solid var(--line);
    }
    .wrap{max-width:1160px; margin:0 auto; padding:10px 16px;
      display:flex; align-items:center; justify-content:space-between; gap:16px}
    .brand{font-weight:700}
    .sub{font-size:.9rem; color:#c7d2fe}
    .wrap a{color:#93c5fd; text-decoration:none}
    .wrap a:hover{text-decoration:underline}

    #map{width:100%; height:100%}

    .panel{
      position:absolute; top:12px; left:12px; z-index:500;
      background:var(--panel); border:1px solid var(--line); border-radius:12px; padding:12px;
      min-width:240px; box-shadow:0 10px 30px rgba(0,0,0,.35)
    }
    .panel h3{margin:0 0 8px; font-size:1rem}
    .legend{display:grid; gap:8px}
    .legend-row{display:flex; align-items:center; gap:10px}
    .dot{width:12px; height:12px; border-radius:999px; border:1px solid rgba(255,255,255,.2)}
    .dot.coop{background:var(--coop)}
    .dot.org{background:var(--org)}
    .dot.pol{background:var(--pol)}
    .dot.mano{background:var(--mano)}
    .star-badge{
      display:inline-flex; align-items:center; justify-content:center;
      width:14px; height:14px; border-radius:3px; font-weight:700; line-height:1;
      background:var(--star); color:#fff;
    }

    /* Tooltip grande */
    .leaflet-tooltip.experience{
      background:rgba(17,24,39,.98);
      color:#e5e7eb;
      border:1px solid #334155;
      border-radius:14px;
      box-shadow:0 12px 36px rgba(0,0,0,.45);
      max-width:860px;
      padding:14px;
      overflow:hidden;
    }
    .balloon{
      display:grid;
      grid-template-columns:240px 1fr;
      gap:16px;
      max-width:820px;
      align-items:flex-start;
    }
    .balloon img{
      width:240px;
      height:240px;
      object-fit:cover;
      border-radius:12px;
    }
    .balloon h4{
      margin:0 0 6px;
      font-size:1.25rem;
      line-height:1.2;
    }
    .balloon p{
      margin:0;
      font-size:1rem;
      line-height:1.5;
      overflow-wrap:anywhere;
      word-break:break-word;
    }
    .balloon .tag{
      margin-top:10px;
      font-size:.9rem;
      opacity:.95;
    }

    @media (max-width: 720px){
      .leaflet-tooltip.experience{ max-width:640px; }
      .balloon{ grid-template-columns:200px 1fr; }
      .balloon img{ width:200px; height:200px; }
    }
    @media (max-width: 480px){
      .leaflet-tooltip.experience{ max-width:92vw; }
      .balloon{ grid-template-columns:1fr; }
      .balloon img{ width:100%; height:220px; }
    }

    .badge{
      position:absolute; right:12px; bottom:12px; z-index:500;
      background:rgba(17,24,39,.85); border:1px solid var(--line);
      padding:6px 10px; border-radius:999px; font-size:.85rem; color:#cbd5e1;
    }
  </style>
</head>
<body>
  <div id="app">
    <header>
      <div class="wrap">
        <div>
          <div class="brand">Eduardo Ferreira Moura</div>
          <div class="sub">Portafolio en un mapa · Cooperación · Organizacional · Políticas · Manos a la obra</div>
        </div>
        <nav>
          <a href="mailto:SEU_EMAIL_AQUI">Contacto</a>
        </nav>
      </div>
    </header>

    <div id="map"></div>

    <div class="panel">
      <h3>Explorar</h3>
      <div class="legend">
        <div class="legend-row"><span class="dot coop"></span> Cooperación internacional</div>
        <div class="legend-row"><span class="dot org"></span> Desafíos organizacionales</div>
        <div class="legend-row"><span class="dot pol"></span> Políticas públicas</div>
        <div class="legend-row"><span class="dot mano"></span> Manos a la obra</div>
        <div class="legend-row"><span class="star-badge">★</span> Destacado para OEI</div>
      </div>
    </div>

    <div class="badge">© <span id="y"></span> EFM</div>
  </div>

  <script>
    const CATEGORIES = {
      coop:{label:'Cooperación',color:'var(--coop)'},
      org:{label:'Organizacional',color:'var(--org)'},
      pol:{label:'Políticas',color:'var(--pol)'},
      mano:{label:'Manos',color:'var(--mano)'}
    };

    // Dados hardcoded (substitua/edite à vontade). 3 imagens por item.
    // NOTE: Ajustei coordenadas corretas para Espanha e Brasil; revise se quiser mais precisão.
    const DATA = [
      {id:1, city:"São Luiz do Paraitinga", country:"Brasil", lat:-23.223, lon:-45.317, category:"coop", star:true,
        title:"Misión de Campo PRODOC UNESCO/IPHAN 914BRZ4018",
        text:"Comprender las estrategias locales tras la inundación de 2010. Referencia para políticas de prevención y mitigación de desastres sobre el patrimonio.",
        images:["slp_2010_a.jpg","slp_2010_b.jpg","slp_2010_c.jpg"]},
      {id:2, city:"Ouro Preto", country:"Brasil", lat:-20.385, lon:-43.503, category:"coop", star:false,
        title:"Misión de Campo PRODOC UNESCO/IPHAN 914BRZ4018",
        text:"Contacto con Defensa Civil para conocer monitoreo de movimientos de masa y presas en alerta. Incorporado a productos técnicos del PRODOC.",
        images:["op_defesa_a.jpg","op_defesa_b.jpg","op_defesa_c.jpg"]},
      {id:3, city:"Ouro Preto", country:"Brasil", lat:-20.385, lon:-43.503, category:"mano", star:false,
        title:"Restauración de objetos en Ouro Preto",
        text:"Conservación de bienes muebles e integrados en el centro histórico.",
        images:["op_manos_obj_a.jpg","op_manos_obj_b.jpg","op_manos_obj_c.jpg"]},
      {id:4, city:"Ouro Preto", country:"Brasil", lat:-20.385, lon:-43.503, category:"mano", star:false,
        title:"Conservación de Inmueble Colonial – Brumas Hostel",
        text:"Mantenimiento y conservación preventiva de una casa del siglo XVIII adaptada como hospedaje.",
        images:["op_brumas_a.jpg","op_brumas_b.jpg","op_brumas_c.jpg"]},
      {id:5, city:"Ouro Preto", country:"Brasil", lat:-20.385, lon:-43.503, category:"mano", star:false,
        title:"Formación técnica – FAOP",
        text:"Curso técnico en Conservación de Bienes Culturales en la tradicional FAOP.",
        images:["op_faop_a.jpg","op_faop_b.jpg","op_faop_c.jpg"]},
      {id:6, city:"Florianópolis", country:"Brasil", lat:-27.595, lon:-48.549, category:"org", star:true,
        title:"Planificación estratégica y clima organizacional",
        text:"BSC, diagnóstico organizacional y evaluación 360°. Fortalecimiento del trabajo en equipo y clima institucional en IPHAN/SC.",
        images:["fln_bsc_a.jpg","fln_bsc_b.jpg","fln_bsc_c.jpg"]},
      {id:7, city:"Belo Horizonte", country:"Brasil", lat:-19.917, lon:-43.934, category:"mano", star:false,
        title:"Parroquia Sagrado Corazón – obras de emergencia",
        text:"Conservación de estucos en templo protegido a nivel estatal de la comunidad sirio-cristiana.",
        images:["bh_paroquia_a.jpg","bh_paroquia_b.jpg","bh_paroquia_c.jpg"]},
      {id:8, city:"Brasília", country:"Brasil", lat:-15.794, lon:-47.882, category:"coop", star:true,
        title:"Consultoría UNESCO/IPHAN – PRODOC",
        text:"Mapa coroplético y repositorio de riesgos. Integración de datos nacionales y fortalecimiento de la gestión de riesgos.",
        images:["bsb_prodoc_a.jpg","bsb_prodoc_b.jpg","bsb_prodoc_c.jpg"]},
      {id:9, city:"Brasília", country:"Brasil", lat:-15.794, lon:-47.882, category:"coop", star:false,
        title:"Congreso Nacional – vulnerabilidades pos-8/01",
        text:"Análisis in situ de vulnerabilidades. Aportes para protocolos institucionales de protección.",
        images:["bsb_congresso_a.jpg","bsb_congresso_b.jpg","bsb_congresso_c.jpg"]},
      {id:10, city:"Brasília", country:"Brasil", lat:-15.794, lon:-47.882, category:"coop", star:false,
        title:"Palacio Itamaraty – conservación de acervos",
        text:"Levantamiento de vulnerabilidades y prácticas de conservación.",
        images:["bsb_itamaraty_a.jpg","bsb_itamaraty_b.jpg","bsb_itamaraty_c.jpg"]},
      {id:11, city:"Brasília", country:"Brasil", lat:-15.794, lon:-47.882, category:"coop", star:false,
        title:"CENAD – reunión multilateral",
        text:"Articulación IPHAN–CENAD–UNESCO para la prevención de desastres que afectan bienes culturales.",
        images:["bsb_cenad_a.jpg","bsb_cenad_b.jpg","bsb_cenad_c.jpg"]},
      {id:12, city:"Brasília", country:"Brasil", lat:-15.794, lon:-47.882, category:"coop", star:false,
        title:"Agencia Nacional de Aguas – asociación estratégica",
        text:"Integración de datos críticos sobre presas e inundaciones al sistema de monitoreo.",
        images:["bsb_ana_a.jpg","bsb_ana_b.jpg","bsb_ana_c.jpg"]},
      {id:13, city:"Brasília", country:"Brasil", lat:-15.794, lon:-47.882, category:"pol", star:true,
        title:"Ministerio de Cultura – evaluador técnico",
        text:"Evaluación PRONAC de proyectos de patrimonio, humanidades, museos y memoria.",
        images:["bsb_minc_a.jpg","bsb_minc_b.jpg","bsb_minc_c.jpg"]},
      {id:14, city:"Valencia", country:"España", lat:39.4699, lon:-0.3763, category:"pol", star:true,
        title:"Universitat Politècnica de València – doctorado",
        text:"Investigación doctoral con enfoque humanista que conecta educación, comunidad y preservación.",
        images:["vlc_upv_a.jpg","vlc_upv_b.jpg","vlc_upv_c.jpg"]},
      {id:15, city:"Roma", country:"Italia", lat:41.9028, lon:12.4964, category:"coop", star:false,
        title:"ICCROM – Asamblea General 2025",
        text:"Delegación que representa al IPHAN. Cooperación internacional y resiliencia patrimonial.",
        images:["rom_iccrom_a.jpg","rom_iccrom_b.jpg","rom_iccrom_c.jpg"]},
      {id:16, city:"Ciudad de Panamá", country:"Panamá", lat:8.9833, lon:-79.5167, category:"org", star:false,
        title:"Conferencia APOYO – gestión institucional",
        text:"Relevamiento nacional de espacios de conservación en la administración pública (con Fiocruz).",
        images:["pty_apoyo_a.jpg","pty_apoyo_b.jpg","pty_apoyo_c.jpg"]},
      {id:17, city:"Guadalajara", country:"México", lat:20.6736, lon:-103.344, category:"pol", star:false,
        title:"Universidad de Guadalajara – “Conservar e Punir”",
        text:"Publicación A2 sobre políticas públicas brasileñas de conservación.",
        images:["gdl_paper_a.jpg","gdl_paper_b.jpg","gdl_paper_c.jpg"]},
      {id:18, city:"Santiago de Chile", country:"Chile", lat:-33.4489, lon:-70.6693, category:"org", star:false,
        title:"SICP – seminario de conservación de papel",
        text:"Levantamiento nacional de laboratorios públicos, foco en papel.",
        images:["scl_sicp_a.jpg","scl_sicp_b.jpg","scl_sicp_c.jpg"]},
      {id:19, city:"Madrid", country:"España", lat:40.4168, lon:-3.7038, category:"org", star:true,
        title:"OEI – consolidación internacional",
        text:"Establecimiento en Madrid para ampliar la actuación iberoamericana en cooperación y patrimonio.",
        images:["mad_oei_a.jpg","mad_oei_b.jpg","mad_oei_c.jpg"]},
      {id:20, city:"Río de Janeiro", country:"Brasil", lat:-22.9068, lon:-43.1729, category:"org", star:false,
        title:"Grupo Libra – selección Proyecto Asia",
        text:"Reclutamiento para 180 posiciones operativas. Gestión de RH y eficiencia organizacional.",
        images:["rio_libra_a.jpg","rio_libra_b.jpg","rio_libra_c.jpg"]},
      {id:21, city:"Río de Janeiro", country:"Brasil", lat:-22.9068, lon:-43.1729, category:"org", star:false,
        title:"UFRJ – formación en Psicología",
        text:"Procesos organizacionales y comunicación institucional aplicados a gestión de equipos.",
        images:["rio_ufrj_a.jpg","rio_ufrj_b.jpg","rio_ufrj_c.jpg"]},
      {id:22, city:"Río de Janeiro", country:"Brasil", lat:-22.9068, lon:-43.1729, category:"coop", star:true,
        title:"Casa de Oswaldo Cruz – hub nacional OCM (ICCROM)",
        text:"Sostenibilidad en laboratorios de conservación. COC como hub nacional del programa.",
        images:["rio_coc_a.jpg","rio_coc_b.jpg","rio_coc_c.jpg"]},
      {id:23, city:"Río de Janeiro", country:"Brasil", lat:-22.9068, lon:-43.1729, category:"pol", star:false,
        title:"IPHAN – maestría en preservación",
        text:"Relaciones de poder e intervención. Aporte crítico al marco normativo de conservación.",
        images:["rio_mestrado_a.jpg","rio_mestrado_b.jpg","rio_mestrado_c.jpg"]},
      {id:24, city:"Río de Janeiro", country:"Brasil", lat:-22.9068, lon:-43.1729, category:"mano", star:false,
        title:"Biblioteca Nacional – encuadernador",
        text:"Encuadernación y conservación de obras raras.",
        images:["rio_bn_a.jpg","rio_bn_b.jpg","rio_bn_c.jpg"]},
      {id:25, city:"Río de Janeiro", country:"Brasil", lat:-22.9068, lon:-43.1729, category:"mano", star:false,
        title:"CCBB – restaurador",
        text:"Restauración y conservación de obras del acervo del CCBB.",
        images:["rio_ccbb_a.jpg","rio_ccbb_b.jpg","rio_ccbb_c.jpg"]},
      {id:26, city:"Pelotas", country:"Brasil", lat:-31.771, lon:-52.342, category:"coop", star:false,
        title:"UFPel/IPHAN-RS – articulación local",
        text:"Coordinación con universidades e IPHAN para respuestas a las inundaciones de 2024.",
        images:["pel_artic_a.jpg","pel_artic_b.jpg","pel_artic_c.jpg"]},
      {id:27, city:"Porto Alegre", country:"Brasil", lat:-30.034, lon:-51.229, category:"coop", star:false,
        title:"IPHAN-RS – respuesta institucional ante inundaciones",
        text:"Análisis de daños y coordinación interinstitucional para mitigación y recuperación.",
        images:["poa_cheias_a.jpg","poa_cheias_b.jpg","poa_cheias_c.jpg"]},
      {id:28, city:"São José dos Campos", country:"Brasil", lat:-23.223, lon:-45.9, category:"coop", star:false,
        title:"CEMADEN – articulación de datos",
        text:"Intercambio de datos IPHAN–CEMADEN. Integración de alertas hidrometeorológicas.",
        images:["sjc_cemaden_a.jpg","sjc_cemaden_b.jpg","sjc_cemaden_c.jpg"]},
      {id:29, city:"Mariana", country:"Brasil", lat:-20.378, lon:-43.416, category:"coop", star:false,
        title:"Bento Rodrigues – restauración posdesastre",
        text:"Protocolos de reconstrucción y preservación de la memoria tras rompimiento de presa.",
        images:["mar_bento_a.jpg","mar_bento_b.jpg","mar_bento_c.jpg"]},
      {id:30, city:"Pirenópolis", country:"Brasil", lat:-15.852, lon:-48.958, category:"coop", star:false,
        title:"ETEC/IPHAN-GO – encuentros multilaterales",
        text:"Reuniones entre IPHAN y municipalidad para gestión del patrimonio ante desastres.",
        images:["pir_etec_a.jpg","pir_etec_b.jpg","pir_etec_c.jpg"]},
      {id:31, city:"Goiás Velho", country:"Brasil", lat:-15.934, lon:-50.14, category:"coop", star:false,
        title:"ETEC/IPHAN-GO – traslado preventivo de bienes",
        text:"Evacuación de bienes culturales durante crecidas del río Vermelho.",
        images:["gv_trad_a.jpg","gv_trad_b.jpg","gv_trad_c.jpg"]},
      {id:32, city:"Goiânia", country:"Brasil", lat:-16.686, lon:-49.264, category:"coop", star:false,
        title:"IPHAN-GO – diagnóstico institucional",
        text:"Mapeo de desafíos y capacidades institucionales con socios locales.",
        images:["gyn_iphan_a.jpg","gyn_iphan_b.jpg","gyn_iphan_c.jpg"]},
      {id:33, city:"Cuiabá", country:"Brasil", lat:-15.601, lon:-56.098, category:"coop", star:false,
        title:"IPHAN-MT – articulación multilateral",
        text:"Encuentro entre IPHAN, secretarías, UFMT y cantero modelo (gobernanza participativa).",
        images:["cba_multi_a.jpg","cba_multi_b.jpg","cba_multi_c.jpg"]},
      {id:34, city:"Rio Branco", country:"Brasil", lat:-9.974, lon:-67.809, category:"coop", star:false,
        title:"IPHAN-AC – coordinación local",
        text:"Prevención de riesgos sobre el patrimonio amazónico con actores regionales.",
        images:["rb_ac_a.jpg","rb_ac_b.jpg","rb_ac_c.jpg"]},
      {id:35, city:"Xapuri", country:"Brasil", lat:-10.651, lon:-68.507, category:"coop", star:true,
        title:"Casa de Chico Mendes – prevención de inundaciones",
        text:"Diagnóstico de vulnerabilidad y propuestas de protección de emergencia.",
        images:["xap_casa_a.jpg","xap_casa_b.jpg","xap_casa_c.jpg"]},
      {id:36, city:"Xapuri", country:"Brasil", lat:-10.651, lon:-68.507, category:"coop", star:false,
        title:"Reserva Extractivista Chico Mendes – diálogo comunitario",
        text:"Estrategias de preservación cultural y ambiental junto a la familia y comunidades locales.",
        images:["xap_reserva_a.jpg","xap_reserva_b.jpg","xap_reserva_c.jpg"]}
    ];

    const map=L.map('map',{zoomControl:false,attributionControl:true}).setView([15,-40],3);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{maxZoom:18,attribution:'© OpenStreetMap contributors'}).addTo(map);

    const markers=[],rotationTimers=new Map();
    function jitter(lat,lon,id){const seed=parseInt(id)||0;const r1=((Math.sin(seed*12.9898)*43758.5453)%1)*2-1;const r2=((Math.sin(seed*78.233)*96432.345)%1)*2-1;const d=0.03;return[lat+r1*d,lon+r2*d];}
    function circleStyle(cat){const color=getComputedStyle(document.documentElement).getPropertyValue(CATEGORIES[cat].color.replace('var(','').replace(')','').trim())||'#60a5fa';return{radius:7,color:"#0b0f1a",weight:2,fillColor:color.trim(),fillOpacity:1};}
    function starIcon(){return L.divIcon({className:'',html:`<div style="width:20px;height:20px;display:grid;place-items:center;filter:drop-shadow(0 0 2px rgba(0,0,0,.35));"><svg viewBox="0 0 24 24" width="20" height="20"><path d="M12 2l2.9 6.3 6.8.6-5.1 4.4 1.6 6.7-6.2-3.7-6.2 3.7 1.6-6.7-5.1-4.4 6.8-.6L12 2z" fill="var(--star)" stroke="#0b0f1a" stroke-width="1"/></svg></div>`,iconSize:[20,20],iconAnchor:[10,10]});}
    function balloonHTML(rec,ttId){const imgs=Array.isArray(rec.images)?rec.images:[];const imgTag=imgs.length?`<img id="${ttId}_img" src="assets/${imgs[0]}" alt="${rec.title}">`:'';const star=rec.star?' ★':'';const catLabel=CATEGORIES[rec.category]?.label||rec.category;return`<div class="balloon">${imgTag}<div><h4>${rec.title}${star}</h4><p>${rec.text||''}</p><div class="tag">${rec.city}${rec.country?', '+rec.country:''} · ${catLabel}</div></div></div>`;}
    function startImageRotation(marker){stopImageRotation(marker);const imgs=marker.rec.images||[];if(imgs.length<=1)return;let idx=0;const imgEl=document.getElementById(`${marker._ttId}_img`);if(!imgEl)return;const id=setInterval(()=>{idx=(idx+1)%imgs.length;imgEl.src=`assets/${imgs[idx]}`;},1400);rotationTimers.set(marker,id);}
    function stopImageRotation(marker){const id=rotationTimers.get(marker);if(id){clearInterval(id);rotationTimers.delete(marker);}}
    DATA.forEach((rec,i)=>{const cat=(rec.category||'').trim().toLowerCase();const[lat,lon]=jitter(rec.lat,rec.lon,rec.id);let marker;if(rec.star){marker=L.marker([lat,lon],{icon:starIcon()});}else{marker=L.circleMarker([lat,lon],circleStyle(cat));}marker.rec=rec;const ttId=`tt_${rec.id}_${Date.now()}_${i}`;marker._ttId=ttId;marker.bindTooltip(balloonHTML(rec,ttId),{direction:'top',className:'experience',sticky:true,opacity:0.98});marker.on('tooltipopen',()=>startImageRotation(marker));marker.on('tooltipclose',()=>stopImageRotation(marker));marker.addTo(map);markers.push(marker);});
    function fitToData(){if(markers.length){const g=L.featureGroup(markers);map.fitBounds(g.getBounds().pad(0.2));}else{map.setView([15,-40],3);}}
    fitToData();
    document.getElementById('y').textContent=new Date().getFullYear();
  </script>
</body>
</html>
